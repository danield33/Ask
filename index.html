<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Special Question...</title>
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link type="text/css" href="/css/index.css" rel="stylesheet"/>
</head>
<body>
<div class="floating-hearts" id="floatingHearts"></div>


<div class="image-container">
  <img src="img/noggin.jpeg" alt="Noggin"/>
  <div class="overlay" id="overlay">
    <p>Guess the password to crack the noggin open</p>
    <input type="text" id="heartInput" placeholder="Hmmm... something happy"/>
    <p class="hint">Hint: Turo</p>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const SECRET_PASSWORD = ["happydaniel1234", "happydaniel123", "happydaniel123!"];
    console.log("loaded")
    function checkPassword() {
      const input = document.getElementById('heartInput').value.toLowerCase();
      const error = document.getElementById('error');
      const overlay = document.getElementById("overlay");

      if (SECRET_PASSWORD.includes(input)) {
        document.body.style.transition = 'opacity 0.5s ease';
        document.body.style.opacity = '0';
        setTimeout(() => {

          overlay.classList.add("fly-away");
          console.log(overlay.classList)
          // window.location.href = 'ask.html';
        }, 1000);
      } else {
        // error.classList.add('show');
        // document.getElementById('password').value = '';
        // setTimeout(() => {
        //   error.classList.remove('show');
        // }, 2000);
      }
    }

    // Enter key support
    document.getElementById('heartInput').addEventListener('keypress', function (e) {
      if (e.key === 'Enter') {
        checkPassword();
      }
    });


    createFloatingHearts();
  });
</script>
<script>
  const input = document.getElementById("heartInput");
  const container = document.querySelector(".image-container");
  const hearts = ['ðŸ’•', 'ðŸ’–', 'ðŸ’—', 'ðŸ’“', 'ðŸ’'];
  const mirror = document.createElement("div");
  document.body.appendChild(mirror);

  mirror.style.position = "absolute";
  mirror.style.visibility = "hidden";
  mirror.style.whiteSpace = "pre";
  mirror.style.font = getComputedStyle(input).font;
  mirror.style.padding = getComputedStyle(input).padding;
  mirror.style.border = getComputedStyle(input).border;

  input.addEventListener("input", () => {
    const heart = document.createElement("div");
    heart.className = "heart";

    heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
    heart.style.left = Math.random() * 100 + '%';
    heart.style.top = Math.random() * 100 + '%';
    heart.style.animationDelay = Math.random();
    heart.style.fontSize = (15 + Math.random() * 20) + 'px';

    const inputRect = input.getBoundingClientRect();
    const containerRect = container.getBoundingClientRect();
    const caretX = getCaretX();

    heart.style.left =
      caretX - containerRect.left + 100 + "px";
    heart.style.top =
      inputRect.top - containerRect.top + "px";

    container.appendChild(heart);

    setTimeout(() => heart.remove(), 1500);
  });


  function getCaretX() {
    const rect = input.getBoundingClientRect();
    const style = getComputedStyle(input);

    mirror.style.width = rect.width + "px";
    mirror.style.font = style.font;
    mirror.style.padding = style.padding;
    mirror.style.border = style.border;

    mirror.textContent =
      input.value.substring(0, input.selectionStart);

    const span = document.createElement("span");
    span.textContent = "|";
    mirror.appendChild(span);

    document.body.appendChild(mirror);
    const caretOffset = span.offsetLeft;
    mirror.innerHTML = "";

    return rect.left + caretOffset;
  }

</script>

</body>
</html>
